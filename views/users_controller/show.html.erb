<html>
  <div>
    <% if current_user.id == @user.id %>
      Welcome <%= current_user.username %>
    <% else %>
      <%= @user.username %>
    <% end %>
  </div>

  <br>

  <% unless current_user == @user || current_user.friends.include?(@user) %>
    <% if current_user.pending_friends.include?(@user) %>
      <div>
        <form action="http://localhost:3000/friendships/<%= pending_friendship_request.id %>" method="POST">
          <input type="hidden" name="_method" value="PUT">
          <input type="hidden" name="my_authenticity_token" value="<%= my_form_authenticity_token %>">
          <input type="submit" value="Accept">
        </form>
      </div>
    <% elsif current_user.requested_friends.include?(@user) %>
      <div>
        <button type="button" disabled>Friend requested</button>
      </div>
    <% else %>
      <div>
        <form action="http://localhost:3000/friendships" method="POST">
          <input type="hidden" name="my_authenticity_token" value="<%= my_form_authenticity_token %>">
          <input type="hidden" name="friendship[requesting_id]" value="<%= current_user.id %>">
          <input type="hidden" name="friendship[requested_id]" value="<%= @user.id %>">
          <input type="submit" value="Add Friend">
        </form>
      </div>
  <% end %>

  <br>

  <div>
    <p>Sent Friend Requests</p>
    <ul>
      <% @user.requested_friends.each do |requested_friend| %>
        <li>
          <a href="http://localhost:3000/users/<%= requested_friend.id %>"><%= requested_friend.username %></a>
        </li>
      <% end %>
    </ul>
  </div>

  <br>

  <div>
    Friend Requests Received
    <ul>
      <% @user.pending_friendship_requests.each do |pending_friendship_request| %>
        <li>
          <a href="http://localhost:3000/users/<%= pending_friendship_request.friend.id %>"><%= pending_friendship_request.user.username %></a>
          <form action="http://localhost:3000/friendships/<%= pending_friendship_request.id %>" method="POST">
            <input type="hidden" name="_method" value="PUT">
            <input type="hidden" name="my_authenticity_token" value="<%= my_form_authenticity_token %>">
            <input type="submit" value="Accept">
          </form>
        </li>
      <% end %>
    </ul>
  </div>

  <br>

  <div>
    Friends
    <ul>
      <% @user.friends.each do |friend| %>
        <li>
          <a href="http://localhost:3000/users/<%= friend.id %>"><%= friend.username %></a>
        </li>
      <% end %>
    </ul>
  </div>

  <div>
    <a href="http://localhost:3000/users">See All Users</a>
  </div>
</html>
